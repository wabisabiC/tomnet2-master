# Instructions to Run ToMNet 2.0
*By Chih-Yi Chen, March 5, 2024*
* Jessica repository version

## Virtual Environment Setup and Execution
1. Install Anaconda.
2. Ensure the Conda command is added to Bash (`export PATH="path/to/anaconda3/bin:$PATH"`).
3. Set up to use the Conda Forge channel (`conda config --add channels conda-forge`).
4. Create `tomnet.yml`:
    - name: tomnet
    - dependencies:
        - absl-py=0.8.1
        - pandas
        - python=3.6.10
        - tensorflow=1.12.0
5. Create a virtual environment using `tomnet.yml` (`conda env create -f path/to/tomnet.yml`).
6. Activate the TomNet virtual environment (`conda activate tomnet`).

## Modify Simulation Data
1. Navigate to `src/scripts/simulation_data_generator/dynamic`.
2. Modify variables in `generate_social_score.py` and execute it to generate social scores (`FNAME`, `MIN`, `MAX`, `MEAN`, `SD`).
3. Modify variables in `simulation_data_dynamic.py` and execute it to generate data:
    - `FNAME` should be the name of the corresponding CSV file generated by `generate_social_score.py`.
    - `VERSION_NAME` will be the name of the output folder, and `AGENT_NAME` will be in the name of the output TXT file; both should be aligned with `FNAME`.
    - Modify `SET_UP_MAZE_TOTAL` to decide how many mazes to generate.
    - Output will be in `src/data/data_dynamic`.

## Model Execution
1. Navigate to `src/models/working_model/model`.
2. Create an empty `__init__.py` file (so Python will see the folder as a package).
3. Move `data_manager.py` and `simulated_data_handler.py` from the `data_management` folder to the previous level (`src/models/working_model/model`).
4. Reindent `data_manager.py` (for debugging purposes).
5. Return to the previous level (`src/models/working_model`).
6. Add two lines at the head of `tomnet2.py`: `import tensorflow as tf` and `import argparse`.
7. Modify and run `tomnet2.py` (consider modifying `LIST_SUBJECTS`, which should correspond to `VERSION_NAME` in `simulation_data_dynamic.py`).
8. The results can be found in `src/models/working_model/test_on_simulation_data/training_result/caches/cache_dS103_v1_commit_/train/_train_test_and_validation_accuracy.csv` (the path can be changed by modifying `self.path_train` in `src/models/working_model/model/main_model.py`).
